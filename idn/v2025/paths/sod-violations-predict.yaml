post:
  security:
    - userAuth: [idn:sod-violation:read]
    - applicationAuth: [idn:sod-violation:read]
  x-sailpoint-userLevels:
    - ORG_ADMIN
  operationId: startPredictSodViolations
  tags:
    - SOD Violations
  summary: Predict sod violations for identity.
  description: >-
    This API is used to check if granting some additional accesses would cause the subject to be in violation of any SOD policies.
    Returns the violations that would be caused.
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: '../schemas/sod/models/IdentityWithNewAccess.yaml'
        example:
          {
            "identityId": "113ffa035a904766b2baf0dda167aa68",
            "accessRefs": [
              {
                "type": "ENTITLEMENT",
                "id": "47687ab86744322e9da8eb9529f416c9"
              },
              {
                "type": "ENTITLEMENT",
                "id": "651e628ac6d7347ea733c8052d53bb76"
              },
              {
                "type": "ENTITLEMENT",
                "id": "a317c1270ae5345392c0dfd7a652f19c"
              },
              {
                "type": "ENTITLEMENT",
                "id": "93b39259048d3b27bbdf8fea4f88471a"
              }
            ],
            "sourceIdAndNativeIdToEntitlementIdsMappings": [
              {
                "sourceId": "34816f63abbe43be816c7a756f18b5f1",
                "nativeIdToEntitlementIdsMappings": [ {
                  "nativeId": "15M23A11",
                  "entitlementIds": [
                    "47687ab86744322e9da8eb9529f416c9",
                    "651e628ac6d7347ea733c8052d53bb76"
                  ]
                },
                  {
                    "nativeId": "AK19J23F",
                    "entitlementIds": [
                      "a317c1270ae5345392c0dfd7a652f19c",
                      "93b39259048d3b27bbdf8fea4f88471a"
                    ]
                  }
                ]
              }
            ]
          }
  responses:
    '200':
      description: Violation Contexts
      content:
        application/json:
          schema:
            $ref: '../schemas/sod/models/ViolationPrediction.yaml'
    '400':
      $ref: '../responses/400.yaml'
    '401':
      $ref: '../responses/401.yaml'
    '403':
      $ref: '../responses/403.yaml'
    '404':
      $ref: '../responses/404.yaml'
    '429':
      $ref: '../responses/429.yaml'
    '500':
      $ref: '../responses/500.yaml'
